# Excel MCP Server 使用手册

## 🎯 快速开始

### 测试文件位置
```
/Users/tangjian/work/excel-mcp-server/data/examples/test_all_features.xlsx
```

### 包含的测试数据

#### 1. 员工信息表 (员工信息)
- **数据量**: 9名员工 × 6个字段
- **字段**: 员工ID, 姓名, 部门, 职位, 入职日期, 薪资
- **部门包括**: 技术部, 销售部, 市场部, 人事部, 财务部

#### 2. 销售数据表 (销售数据)
- **数据量**: 10条销售记录 × 7个字段
- **字段**: 日期, 产品名称, 销量, 单价, 销售员, 客户类型, 地区
- **产品包括**: iPhone系列, MacBook系列, iPad系列等

#### 3. 产品目录表 (产品目录)
- **数据量**: 12个产品 × 8个字段
- **字段**: 产品ID, 产品名称, 分类, 品牌, 价格, 库存, 状态, 供应商
- **分类包括**: 手机, 笔记本, 平板, 耳机, 手表等

#### 4. 测试公式表 (测试公式)
- **数据量**: 9种公式类型 × 4个字段
- **公式类型**: 基本运算, 求和, 平均值, 最大值, 计数, 条件判断等

## 🛠️ 已验证的14个MCP工具

### 文件操作
- ✅ `excel_create_file` - 创建Excel文件
- ✅ `excel_list_sheets` - 列出所有工作表

### 工作表管理
- ✅ `excel_create_sheet` - 创建新工作表
- ✅ `excel_delete_sheet` - 删除工作表
- ✅ `excel_rename_sheet` - 重命名工作表

### 数据操作
- ✅ `excel_get_range` - 读取指定范围数据
- ✅ `excel_update_range` - 批量更新数据
- ✅ `excel_regex_search` - 正则表达式搜索

### 结构调整
- ✅ `excel_insert_rows` - 插入行
- ✅ `excel_insert_columns` - 插入列
- ✅ `excel_delete_rows` - 删除行
- ✅ `excel_delete_columns` - 删除列

### 高级功能
- ✅ `excel_set_formula` - 设置单元格公式
- ✅ `excel_format_cells` - 格式化单元格

## 🧪 测试示例

### 1. 搜索测试
```python
# 搜索技术部员工
pattern: "技术部"
结果: 找到3个匹配项

# 搜索5位数薪资
pattern: "\d{5}"
结果: 找到14个匹配项
```

### 2. 格式化测试
```python
# 标题行格式化
range: "A1:F1"
样式: 居中对齐 + 蓝色背景 + 白色粗体字
```

### 3. 公式测试
```python
# 数学运算: =10+20*3 → 70
# 日期函数: =TODAY() → 当前日期
# 四舍五入: =ROUND(3.14159,2) → 3.14
```

## 🎉 核心特性

- **🌐 完整中文支持** - 完美处理中文字段和数据
- **⚡ 高性能处理** - 流畅处理多表格复杂数据
- **🔍 强大搜索** - 正则表达式搜索支持
- **🎨 丰富格式化** - 字体、颜色、对齐等样式
- **📊 公式支持** - 数学、日期、逻辑公式
- **🔧 结构灵活** - 行列插入删除、工作表管理

## 📈 测试覆盖率: 100%

所有14个MCP工具均已完成测试验证，Excel MCP Server已达到生产就绪状态！
