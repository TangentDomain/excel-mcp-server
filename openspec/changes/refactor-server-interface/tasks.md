## 1. 数据安全保护 (最高优先级)
- [x] 1.1 修改默认安全行为 - excel_update_range默认insert_mode=True
- [x] 1.2 实现操作预览机制 - 在执行前显示影响范围和数据
- [x] 1.3 创建自动备份系统 - 重大操作前自动创建备份文件
- [x] 1.4 实现撤销恢复能力 - 提供操作回滚和数据恢复功能

## 2. 多层安全验证
- [x] 2.1 增强参数验证 - 严格验证range格式和文件路径
- [x] 2.2 实现数据影响评估 - 分析操作将影响多少单元格
- [x] 2.3 添加危险操作警告 - 对大范围操作进行特别警告
- [x] 2.4 文件状态检查 - 验证文件是否被其他程序锁定

## 3. 用户确认机制
- [x] 3.1 创建操作确认步骤 - 危险操作需要明确确认
- [x] 3.2 实现操作摘要显示 - 显示操作前后的数据对比
- [x] 3.3 添加操作范围可视化 - 清晰标识将要影响的区域
- [x] 3.4 提供操作取消能力 - 允许在最后一刻取消操作

## 4. 安全的LLM提示词
- [x] 4.1 重写安全优先提示词 - 强调安全操作原则
- [x] 4.2 提供安全操作指导 - 推荐安全的工具调用序列
- [x] 4.3 突出安全注意事项 - 在工具描述中强调安全风险
- [x] 4.4 创建安全最佳实践 - 提供安全操作的示例和建议

## 5. 测试和验证
- [x] 5.1 创建安全测试用例 - 验证各种误操作场景的保护
- [x] 5.2 测试备份恢复机制 - 确保数据能正确恢复
- [x] 5.3 验证用户确认流程 - 测试各种确认场景
- [x] 5.4 安全性渗透测试 - 尝试各种可能导致数据破坏的操作
