{
  "id": "9d2578ba-fd2e-489c-bb47-e5e65621ab71",
  "title": "Excelæ­£åˆ™æœç´¢æ¥å£sheet_nameå‚æ•°æ”¹è¿›",
  "details": "# Excel MCPæ¥å£æ”¹è¿›ï¼šæ·»åŠ å¯é€‰sheet_nameå‚æ•°\n\n## ğŸ¯ æ”¹è¿›ç›®æ ‡\nä¸ºexcel_regex_searchæ¥å£æ·»åŠ å¯é€‰çš„sheet_nameå‚æ•°ï¼Œå¹³è¡¡ç²¾ç¡®æ€§å’Œçµæ´»æ€§éœ€æ±‚ã€‚\n\n## ğŸ”§ å®æ–½çš„ä¿®æ”¹\n\n### 1. æœåŠ¡å™¨æ¥å£ä¿®æ”¹ (server.py)\n```python\ndef excel_regex_search(\n    file_path: str,\n    pattern: str,\n    sheet_name: Optional[str] = None,  # æ–°å¢å¯é€‰å‚æ•°\n    flags: str = \"\",\n    search_values: bool = True,\n    search_formulas: bool = False\n) -> Dict[str, Any]:\n```\n\n**å…³é”®å˜æ›´**ï¼š\n- å‚æ•°ä½ç½®ï¼šå°†sheet_nameæ”¾åœ¨patternä¹‹åï¼Œä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°\n- ç±»å‹å®šä¹‰ï¼šOptional[str] = Noneï¼Œä¿æŒå‘åå…¼å®¹\n- æ–‡æ¡£æ›´æ–°ï¼šæ·»åŠ äº†æ–°å‚æ•°è¯´æ˜å’Œä½¿ç”¨ç¤ºä¾‹\n\n### 2. æ ¸å¿ƒå®ç°ä¿®æ”¹ (core/excel_search.py)\n\n#### regex_searchæ–¹æ³•\n- æ·»åŠ sheet_nameå‚æ•°\n- ä¼ é€’å‚æ•°ç»™_search_workbookæ–¹æ³•\n\n#### _search_workbookæ–¹æ³•\n- æ”¯æŒå·¥ä½œè¡¨åç§°è¿‡æ»¤\n- æ·»åŠ å·¥ä½œè¡¨å­˜åœ¨æ€§éªŒè¯\n- ä¿æŒåŸæœ‰æœç´¢æ‰€æœ‰å·¥ä½œè¡¨çš„åŠŸèƒ½\n\n```python\ndef _search_workbook(self, workbook, regex, search_values, search_formulas, sheet_name=None):\n    if sheet_name:\n        if sheet_name not in workbook.sheetnames:\n            raise ValueError(f\"å·¥ä½œè¡¨ '{sheet_name}' ä¸å­˜åœ¨\")\n        sheet_names = [sheet_name]\n    else:\n        sheet_names = workbook.sheetnames\n```\n\n### 3. å•å…ƒæµ‹è¯•å¢å¼º (tests/test_excel_search.py)\næ·»åŠ äº†`test_regex_search_specific_sheet`æµ‹è¯•æ–¹æ³•ï¼Œè¦†ç›–ï¼š\n- æœç´¢æ‰€æœ‰å·¥ä½œè¡¨ï¼ˆåŸæœ‰åŠŸèƒ½ï¼‰\n- æœç´¢æŒ‡å®šå·¥ä½œè¡¨ï¼ˆæ–°åŠŸèƒ½ï¼‰\n- æœç´¢ä¸å­˜åœ¨å·¥ä½œè¡¨çš„é”™è¯¯å¤„ç†\n\n## âœ… éªŒè¯ç»“æœ\n- **æ‰€æœ‰ç°æœ‰æµ‹è¯•é€šè¿‡**ï¼š13/13 passed\n- **æ–°åŠŸèƒ½æµ‹è¯•é€šè¿‡**ï¼šsheet_nameå‚æ•°åŠŸèƒ½æ­£å¸¸\n- **å‘åå…¼å®¹æ€§**ï¼šç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹\n\n## ğŸ‰ ä½¿ç”¨ç¤ºä¾‹\n\n```python\n# æœç´¢æ‰€æœ‰å·¥ä½œè¡¨ï¼ˆåŸæœ‰è¡Œä¸ºï¼‰\nresult = excel_regex_search(\"data.xlsx\", r\"\\\\d+\")\n\n# æœç´¢æŒ‡å®šå·¥ä½œè¡¨ï¼ˆæ–°åŠŸèƒ½ï¼‰\nresult = excel_regex_search(\"data.xlsx\", r\"\\\\d+\", sheet_name=\"Sheet1\")\n\n# å…¶ä»–å‚æ•°ç»„åˆ\nresult = excel_regex_search(\"data.xlsx\", r\"\\\\d+\", sheet_name=\"Sheet1\", flags=\"i\")\n```\n\n## ğŸ“Š å½±å“è¯„ä¼°\n- **å…¼å®¹æ€§**ï¼š100% å‘åå…¼å®¹\n- **æ€§èƒ½**ï¼šæŒ‡å®šå·¥ä½œè¡¨æ—¶æ€§èƒ½æ›´å¥½ï¼ˆæœç´¢èŒƒå›´ç¼©å°ï¼‰\n- **å‡†ç¡®æ€§**ï¼šæä¾›ç²¾ç¡®æ§åˆ¶é€‰é¡¹\n- **çµæ´»æ€§**ï¼šä¿æŒåŸæœ‰å…¨å±€æœç´¢èƒ½åŠ›\n\nè¿™ä¸ªæ”¹è¿›å®Œç¾åœ°æ»¡è¶³äº†ç”¨æˆ·çš„éœ€æ±‚ï¼šæ—¢æä¾›äº†ç±»ä¼¼\"äºŒè¿›åˆ¶\"çš„å‡†ç¡®æ€§æ§åˆ¶ï¼Œåˆä¿æŒäº†çµæ´»æ€§ã€‚",
  "category": "code_improvement",
  "dateCreated": "2025-08-22T02:28:38.426Z",
  "dateUpdated": "2025-08-22T02:28:38.426Z"
}