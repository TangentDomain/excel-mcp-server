Metadata-Version: 2.4
Name: excel-mcp-server-fastmcp
Version: 1.0.0
Summary: Excel MCP Server based on FastMCP and openpyxl
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: fastmcp>=0.1.0
Requires-Dist: openpyxl>=3.1.0
Requires-Dist: mcp>=1.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.21.0; extra == "dev"

# Excel MCP Server (FastMCP)

åŸºäº FastMCP å’Œ openpyxl å®ç°çš„ Excel æ“ä½œ MCP æœåŠ¡å™¨

## åŠŸèƒ½ç‰¹æ€§

- **ğŸ” æ­£åˆ™æœç´¢**: åœ¨Excelæ–‡ä»¶ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœç´¢å•å…ƒæ ¼å†…å®¹
- **ğŸ“Š èŒƒå›´è·å–**: è¯»å–æŒ‡å®šèŒƒå›´çš„Excelæ•°æ®ï¼Œæ”¯æŒæ ¼å¼ä¿¡æ¯
- **âœï¸ èŒƒå›´ä¿®æ”¹**: ä¿®æ”¹æŒ‡å®šèŒƒå›´çš„æ•°æ®ï¼Œä¿æŒå…¬å¼å’Œæ ¼å¼å®Œæ•´æ€§

## å·¥å…·åˆ—è¡¨

### excel_regex_search
åœ¨Excelæ–‡ä»¶ä¸­æœç´¢ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„å•å…ƒæ ¼
- `file_path`: Excelæ–‡ä»¶è·¯å¾„
- `pattern`: æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼
- `flags`: æ­£åˆ™æ ‡å¿— (i=å¿½ç•¥å¤§å°å†™, m=å¤šè¡Œ, s=ç‚¹åŒ¹é…æ¢è¡Œ)
- `search_values`: æ˜¯å¦æœç´¢æ˜¾ç¤ºå€¼
- `search_formulas`: æ˜¯å¦æœç´¢å…¬å¼

### excel_get_range
è·å–Excelæ–‡ä»¶æŒ‡å®šèŒƒå›´çš„æ•°æ®
- `file_path`: Excelæ–‡ä»¶è·¯å¾„
- `range_expression`: èŒƒå›´è¡¨è¾¾å¼ (å¦‚ 'A1:C10' æˆ– 'Sheet1!A1:C10')
- `include_formatting`: æ˜¯å¦åŒ…å«æ ¼å¼ä¿¡æ¯

### excel_update_range
ä¿®æ”¹Excelæ–‡ä»¶æŒ‡å®šèŒƒå›´çš„æ•°æ®
- `file_path`: Excelæ–‡ä»¶è·¯å¾„
- `range_expression`: èŒƒå›´è¡¨è¾¾å¼
- `data`: äºŒç»´æ•°æ®æ•°ç»„
- `preserve_formulas`: æ˜¯å¦ä¿ç•™ç°æœ‰å…¬å¼

## å®‰è£…

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
venv\Scripts\activate  # Windows
# source venv/bin/activate  # Linux/Mac

# å®‰è£…ä¾èµ–
pip install fastmcp openpyxl mcp

# è¿è¡ŒæœåŠ¡å™¨
python server.py
```

## ä½¿ç”¨ç¤ºä¾‹

### 1. æ­£åˆ™æœç´¢ç¤ºä¾‹
```python
# æœç´¢åŒ…å«é‚®ç®±åœ°å€çš„å•å…ƒæ ¼
result = excel_regex_search(
    file_path="example.xlsx",
    pattern=r"\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b",
    flags="i"
)
```

### 2. èŒƒå›´è·å–ç¤ºä¾‹
```python
# è·å–A1:C10èŒƒå›´çš„æ•°æ®
result = excel_get_range(
    file_path="example.xlsx",
    range_expression="Sheet1!A1:C10",
    include_formatting=True
)
```

### 3. èŒƒå›´ä¿®æ”¹ç¤ºä¾‹
```python
# ä¿®æ”¹B2:D4èŒƒå›´çš„æ•°æ®
result = excel_update_range(
    file_path="example.xlsx",
    range_expression="B2:D4",
    data=[
        ["æ–°å€¼1", "æ–°å€¼2", "æ–°å€¼3"],
        [100, 200, 300],
        ["=SUM(B2:C2)", "æ–‡æœ¬", 42]
    ]
)
```

## æŠ€æœ¯å®ç°

- åŸºäº **FastMCP** æ¡†æ¶ï¼Œä½¿ç”¨ `@mcp.tool()` è£…é¥°å™¨å®šä¹‰å·¥å…·
- ä½¿ç”¨ **openpyxl** è¿›è¡ŒExcelæ–‡ä»¶æ“ä½œï¼Œæ”¯æŒ .xlsx/.xlsm æ ¼å¼
- æ”¯æŒå…¬å¼ä¿æŠ¤å’Œæ ¼å¼ä¿æŒ
- å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œè¾“å…¥éªŒè¯

## é…ç½®

æœåŠ¡å™¨è¿è¡Œåœ¨æ ‡å‡†è¾“å…¥è¾“å‡ºæ¨¡å¼ï¼Œå¯é€šè¿‡Claude Desktopæˆ–å…¶ä»–MCPå®¢æˆ·ç«¯è¿æ¥ã€‚
